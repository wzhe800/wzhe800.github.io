<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.3">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.3" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="Hexo, NexT" />


<meta name="description" content="所学即所得">
<meta property="og:type" content="website">
<meta property="og:title" content="learningByDoing">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="learningByDoing">
<meta property="og:description" content="所学即所得">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="learningByDoing">
<meta name="twitter:description" content="所学即所得">






  <link rel="canonical" href="http://yoursite.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>learningByDoing</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">learningByDoing</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
        </li>
      

      
    </ul>
  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/17/SSM整合/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/17/SSM整合/" itemprop="url">SSM整合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-17T00:00:00+08:00">2017-11-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/" itemprop="url" rel="index"><span itemprop="name">JavaWeb基础</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/SSM框架/" itemprop="url" rel="index"><span itemprop="name">SSM框架</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h1><ol>
<li>sqlMapConfig.xml<ol>
<li>别名</li>
</ol>
</li>
<li>cn.dao配置Mapper</li>
<li>cn.pojo配置pojo</li>
</ol>
<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><ol>
<li>applicationContext.xml<ol>
<li>开启注解赋值</li>
<li>开启类扫描</li>
<li>数据源连接池</li>
<li>SqlSessionFactory</li>
<li>Mapper动态代理扫描开发</li>
</ol>
</li>
<li>web.xml中配置spring容器随服务器开启而加载(listener)，并指定配置文件位置</li>
</ol>
<h1 id="Springmvc"><a href="#Springmvc" class="headerlink" title="Springmvc"></a>Springmvc</h1><ol>
<li>springmvc.xml<ol>
<li>开启类扫描</li>
<li>三大组件</li>
</ol>
</li>
<li>web.xml中配置前端控制器(servlet),并指定配置文件位置</li>
</ol>
<h1 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h1><p>db.properties与log4j.properties</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/17/spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/17/spring/" itemprop="url">spring</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-17T00:00:00+08:00">2017-11-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/" itemprop="url" rel="index"><span itemprop="name">JavaWeb基础</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/SSM框架/" itemprop="url" rel="index"><span itemprop="name">SSM框架</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="框架搭建"><a href="#框架搭建" class="headerlink" title="框架搭建"></a>框架搭建</h1><ol>
<li>导包</li>
<li>创建对象</li>
<li>写配置文件（建议命名为applicationContext.xml放置到src下），写 <beans>标签并导入xsd约束</beans></li>
<li>注册对象到容器</li>
</ol>
<h1 id="IOC-amp-DI"><a href="#IOC-amp-DI" class="headerlink" title="IOC&amp;DI"></a>IOC&amp;DI</h1><h2 id="IOC-Inverse-Of-Control，控制反转"><a href="#IOC-Inverse-Of-Control，控制反转" class="headerlink" title="IOC:Inverse Of Control，控制反转"></a>IOC:Inverse Of Control，控制反转</h2><p>对象的创建以及依赖关系由开发人员自己完成并注入    反转成了        Spring完成对象的创建并注入依赖关系</p>
<h2 id="DI-Dependency-Injection-依赖注入"><a href="#DI-Dependency-Injection-依赖注入" class="headerlink" title="DI:Dependency Injection 依赖注入"></a>DI:Dependency Injection 依赖注入</h2><p>实现IOC需要DI作支持</p>
<p>注入方式：</p>
<ol>
<li>set方法</li>
<li>构造方法</li>
<li>字段</li>
</ol>
<p>注入类型：</p>
<ol>
<li>值类型（八大基本数据类型）</li>
<li>引用类型（依赖对象）</li>
</ol>
<h1 id="ApplicationContext-amp-BeanFactory"><a href="#ApplicationContext-amp-BeanFactory" class="headerlink" title="ApplicationContext&amp;BeanFactory"></a>ApplicationContext&amp;BeanFactory</h1><p>BeanFactory是spring的原始接口，实现功能较为单一。其接口实现类的容器的特点是每次在获得对象时才会创建对象。</p>
<p>ApplicationContext容器每次启动时就会创建配置中的所有对象，提供更多的功能。其加载配置文件有两个方法：</p>
<ol>
<li>从类路径加载：ClassPathXmlApplicationContext</li>
<li>从硬盘路径加载：FileSystemXmlApplicationContext</li>
</ol>
<p>因此在web开发中使用ApplicationContext，在资源匮乏的情况下使用BeanFactory</p>
<h1 id="配置详解"><a href="#配置详解" class="headerlink" title="配置详解"></a>配置详解</h1><h2 id="Bean元素"><a href="#Bean元素" class="headerlink" title="Bean元素"></a>Bean元素</h2><p>使用该元素描述需要Spring容器管理的对象</p>
<h3 id="空参构造对象"><a href="#空参构造对象" class="headerlink" title="空参构造对象"></a>空参构造对象</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	name属性：给被管理的对象起个名字，根据该名称获得对象，可使用特殊字符</span></span><br><span class="line"><span class="comment">	class属性：被管理对象的完整类名</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="静态工厂（了解）"><a href="#静态工厂（了解）" class="headerlink" title="静态工厂（了解）"></a>静态工厂（了解）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//spring通过调用这个类的静态方法来创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User <span class="title">createUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	调用UserFactory的createUser方法来创建user2对象，放入容器</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"domain.UserFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createUser"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="实例工厂（了解）"><a href="#实例工厂（了解）" class="headerlink" title="实例工厂（了解）"></a>实例工厂（了解）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//spring通过调用这个类的静态方法来创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User <span class="title">createUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	调用UserFactory对象的createUser2方法来创建user3对象，放入容器</span></span><br><span class="line"><span class="comment">	与静态工厂的区别是：这个方法还要创建UserFactory对象。而静态工厂是直接调用UserFactory类的静态方法</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"userFactory"</span> <span class="attr">class</span>=<span class="string">"domain.UserFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user3"</span> <span class="attr">factory-bean</span>=<span class="string">"userFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createUser2"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="scope属性"><a href="#scope属性" class="headerlink" title="scope属性"></a>scope属性</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	singleton（默认）:单例对象。对象在容器中只会存在一个实例。</span></span><br><span class="line"><span class="comment">	prototype:多例原型。被标识为多例的对象，每次在获得时才会创建新的对象。action对象必须要配成prototype。</span></span><br><span class="line"><span class="comment">	request（了解）:web环境下，对象与request生命周期一致。</span></span><br><span class="line"><span class="comment">	session（了解）:web环境下，对象与session生命周期一致。</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="生命周期属性（了解）"><a href="#生命周期属性（了解）" class="headerlink" title="生命周期属性（了解）"></a>生命周期属性（了解）</h3><p>可配置一个方法作为生命周期初始化方法，spring会在对象创建后立即调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span> <span class="attr">init-method</span>=<span class="string">"init"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>同时可配置一个方法作为生命周期销毁方法，spring容器会在关闭并销毁所有对象之前调用，做后处理工作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span> <span class="attr">destory-method</span>=<span class="string">"destory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>bean中要有这两个方法。</p>
<h2 id="模块化配置"><a href="#模块化配置" class="headerlink" title="模块化配置"></a>模块化配置</h2><p>当容器中的对象太多，会很乱，因此引入模块化配置，可导入其它spring配置文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	在struts2中是include file</span></span><br><span class="line"><span class="comment">	在hibernate中是mapping resource</span></span><br><span class="line"><span class="comment">	在spring中是import resource</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"domain/applicationContext.xml"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="单一属性注入"><a href="#单一属性注入" class="headerlink" title="单一属性注入"></a>单一属性注入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此为对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> Car car;</span><br><span class="line">  set与get</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> color;</span><br><span class="line">  set与get</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="set方法注入"><a href="#set方法注入" class="headerlink" title="set方法注入"></a>set方法注入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		值类型注入：为user对象中名为name的属性注入tom作为值</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"tom"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		对象类型注入：为user对象中名为car的属性注入下方的car对象</span></span><br><span class="line"><span class="comment"> 	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"car"</span> <span class="attr">ref</span>=<span class="string">"car"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"car"</span> <span class="attr">class</span>=<span class="string">"domain.Car"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"兰博基尼"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="构造函数方法注入"><a href="#构造函数方法注入" class="headerlink" title="构造函数方法注入"></a>构造函数方法注入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 假设构造函数为public User(String name, Integer age, Car car) --&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 因为spring不知道name和age和car在构造函数中是如何放置的，因此最好用index属性指明位置 --&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 因为spring不知道构造函数参数的类型，因此要用type属性指明完整类名 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"jerry"</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"car"</span> <span class="attr">ref</span>=<span class="string">"car"</span> <span class="attr">index</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"car"</span> <span class="attr">class</span>=<span class="string">"domain.Car"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"兰博基尼"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="p名称空间注入（了解、未学）"><a href="#p名称空间注入（了解、未学）" class="headerlink" title="p名称空间注入（了解、未学）"></a>p名称空间注入（了解、未学）</h3><h3 id="spel注入（了解、未学）"><a href="#spel注入（了解、未学）" class="headerlink" title="spel注入（了解、未学）"></a>spel注入（了解、未学）</h3><h2 id="集合属性注入"><a href="#集合属性注入" class="headerlink" title="集合属性注入"></a>集合属性注入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此为对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionBean</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Object[] arr;</span><br><span class="line">  <span class="keyword">private</span> List list;</span><br><span class="line">  <span class="keyword">private</span> Map map;</span><br><span class="line">  <span class="keyword">private</span> Properties property;</span><br><span class="line">  get与set</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"cb"</span> <span class="attr">class</span>=<span class="string">"domain.CollectionBean"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 若arr或list中只准备注入一个对象/值，则直接使用ref/value即可 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"arr"</span> <span class="attr">value</span>=<span class="string">"tom"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 否则如下注入数组 --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"arr"</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">value</span>&gt;</span>value1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">value</span>&gt;</span>value2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"otherObject"</span> /&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 如下注入list --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">value</span>&gt;</span>value3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">value</span>&gt;</span>value4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"otherObject"</span> /&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 如下注入map --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql:///crm"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"car"</span> <span class="attr">value-ref</span>=<span class="string">"car"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">          	<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key-ref</span>=<span class="string">"user3"</span> <span class="attr">value-ref</span>=<span class="string">"user2"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 如下注入properties --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prop"</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"userName"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span> </span><br><span class="line">          	<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"password"</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h1><p>在web.xml中利用监听器元素，使applicationContext的生命周期与ServletContext生命周期一致，这样在发出请求拿到对象时，就不用每次都创建一个applicationContext容器。此容器在整个项目周期中应保持只有一个。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定加载spring配置文件的位置  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里的监听器就是servletContext的监听器。因此可以先获得servletContext对象，再从其域中取出applicationContext容器。getAttribute方法被spring封装到工具包中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ServletContext sc = ServletActionContext.getServletContext();</span><br><span class="line">WebApplicationContext ac = WebApplicationContextUtils.getWebApplicationContext(sc);</span><br><span class="line">CustomerService customerService = (CustomerService)ac.getBean(<span class="string">"customerService"</span>);</span><br></pre></td></tr></table></figure>
<h1 id="注解配置spring"><a href="#注解配置spring" class="headerlink" title="注解配置spring"></a>注解配置spring</h1><ol>
<li>导入context schema</li>
<li>开启使用注解代理配置文件</li>
<li>在类中使用注解</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在beans元素下加上context:component-scan子元素，会自动扫描识别domain包及其子包下的所有组件(类)的注解 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"domain"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&lt;bean name="user" class="domain.User"&gt;&lt;/bean&gt;</span></span><br><span class="line"><span class="meta">@Component</span>(<span class="string">"user"</span>)		<span class="comment">//变成了下面的三个可识别的注解，效果一样</span></span><br><span class="line"><span class="meta">@Service</span>(<span class="string">"user"</span>)	<span class="comment">//service层</span></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">"user"</span>)		<span class="comment">//web层</span></span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">"user"</span>)		<span class="comment">//dao层   这里用Repository</span></span><br><span class="line"><span class="meta">@Scope</span>(scopeName=<span class="string">"prototype"</span>)   <span class="comment">//scope属性，不加默认为singleton</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"tom"</span>)		<span class="comment">//通过反射的Field赋值，破坏封装性，不推荐</span></span><br><span class="line">    <span class="keyword">private</span> String user_name;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@Autowired</span>	<span class="comment">//自动装配成员对象，若容器匹配到多个类型一致的对象则无法选择具体注入哪一个对象，会报错</span></span><br><span class="line">  	<span class="meta">@Qualifier</span>(<span class="string">"car2"</span>)	<span class="comment">//指定名称封装成员对象,要与Autowired一起使用</span></span><br><span class="line">  	<span class="meta">@Resource</span>(name=<span class="string">"car2"</span>)	<span class="comment">//推荐只用Resource，直接指定 </span></span><br><span class="line">  	<span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUser_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> user_name;</span><br><span class="line">      &#125;</span><br><span class="line">	<span class="meta">@Value</span>(<span class="string">"tom"</span>)	<span class="comment">//通过set方法赋值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_name</span><span class="params">(String user_name)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.user_name = user_name;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="meta">@PostConstruct</span>	<span class="comment">//初始化方法，在构造后执行，不是spring注解</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"init"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@PreDestroy</span>		<span class="comment">//后处理方法，在销毁前执行，不是spring注解</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"destory"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="spring与junit整合"><a href="#spring与junit整合" class="headerlink" title="spring与junit整合"></a>spring与junit整合</h1><p>每次若在@Test方法下创建一个容器会很麻烦且占用内存，spring有专门的test包，junit也有专门指定测试环境的注解。如下整合测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试时自动创建容器，测试完会自动销毁</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="comment">//指定配置文件位置</span></span><br><span class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Resource</span>(name=<span class="string">"user1"</span>)	<span class="comment">//将名为user1的对象注入到user属性中</span></span><br><span class="line">  <span class="keyword">private</span> User user;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    syso(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="spring中的aop思想"><a href="#spring中的aop思想" class="headerlink" title="spring中的aop思想"></a>spring中的aop思想</h1><p>spring中若代理对象有接口，则使用动态代理。若没有接口，则使用cglib代理。</p>
<h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><p>spring能够为容器中管理的对象生成动态代理对象。</p>
<p>若给service对象生成动态代理对象，则可以在动态代理对象中统一进行事务的处理。</p>
<p><strong>缺陷</strong>：<code>Proxy.newProxyInstance(classLoader,Interface[] arr, InvocationHandler handler)</code>被代理对象必须要实现接口才可使用动态代理</p>
<h2 id="cglib代理"><a href="#cglib代理" class="headerlink" title="cglib代理"></a>cglib代理</h2><p>可以对任何类生成代理。与动态代理不同，它对代理对象进行继承代理而不是接口代理。若目标对象被final修饰，则该类无法被cglib代理。</p>
<h2 id="aop名词解释"><a href="#aop名词解释" class="headerlink" title="aop名词解释"></a>aop名词解释</h2><ol>
<li>JoinPoint(连接点)：目标对象中，所有可以增强的方法</li>
<li>PointCut(切入点)：目标对象中，已经增强的方法</li>
<li>Advice(通知/增强)：要增强的代码。如开启事务与提交事务。</li>
<li>Target(目标对象)：被代理对象</li>
<li>Weaving(织入)：将通知应用到连接点形成切入点</li>
<li>Proxy(代理)： 代理对象</li>
<li>aspect(切面)：切入点+通知</li>
</ol>
<h2 id="aop准备工作"><a href="#aop准备工作" class="headerlink" title="aop准备工作"></a>aop准备工作</h2><ol>
<li><p>导包</p>
</li>
<li><p>准备目标对象（ServiceImpl）</p>
</li>
<li><p>准备通知</p>
<ol>
<li><p>前置通知：目标方法运行前调用</p>
</li>
<li><p>后置通知1：目标方法运行后调用，若出现异常不会调用</p>
</li>
<li><p>后置通知2：目标方法运行后调用，若出现异常仍会调用</p>
</li>
<li><p>环绕通知：目标方法运行前后都会调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//环绕通知</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"beforeAround"</span>);</span><br><span class="line">		Object proceed = pjp.proceed();   <span class="comment">//调用目标方法</span></span><br><span class="line">		System.out.println(<span class="string">"afterAround"</span>);</span><br><span class="line">		<span class="keyword">return</span> proceed;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>异常拦截通知：若出现异常则会调用</p>
</li>
</ol>
</li>
<li><p>利用配置将通知织入目标对象</p>
<ol>
<li><p>导入aop约束</p>
</li>
<li><p>配置目标对象</p>
</li>
<li><p>配置通知对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"myadvice"</span> <span class="attr">class</span>=<span class="string">"advice"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置织入</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置切入点</span></span><br><span class="line"><span class="comment">		第一个*代表返回任意类型</span></span><br><span class="line"><span class="comment">		*Action1代表test包下任意以Action1结尾的类</span></span><br><span class="line"><span class="comment">		*(..)代表含任意参数的任意方法	*为方法 (..)为参数</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* test.*Action1.*(..))"</span> <span class="attr">id</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"myAdvice"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"before"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"afterReturning"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"after"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"around"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"afterException"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pc"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="spring整合jdbc"><a href="#spring整合jdbc" class="headerlink" title="spring整合jdbc"></a>spring整合jdbc</h1><h2 id="jdbcTemplate（模板对象）"><a href="#jdbcTemplate（模板对象）" class="headerlink" title="jdbcTemplate（模板对象）"></a>jdbcTemplate（模板对象）</h2><p>spring提供了可操作数据库的对象，封装了jdbc技术，与DBUtils中的QueryRunner非常相似。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建连接池</span></span><br><span class="line">ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">dataSource.setDriverClass(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">dataSource.setJdbcUrl(<span class="string">"jdbc:mysql:///cst"</span>);</span><br><span class="line">dataSource.setUser(<span class="string">"root"</span>);</span><br><span class="line">dataSource.setPassword(<span class="string">"WZhe941127"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建jdbc模板对象</span></span><br><span class="line">JdbcTemplate jt = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">String sql = <span class="string">"insert into test values('bbb', 'aaa')"</span>;</span><br><span class="line"></span><br><span class="line">jt.update(sql);</span><br></pre></td></tr></table></figure>
<h2 id="实现dao的API"><a href="#实现dao的API" class="headerlink" title="实现dao的API"></a>实现dao的API</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//增删改用update</span></span><br><span class="line"><span class="comment">//查找用query</span></span><br><span class="line"><span class="comment">//主要是查找，当查找的结果不是基本数据类型时，要自己手动完成从ResultSet到对象类型的封装。</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoDaoImpl</span> <span class="keyword">implements</span> <span class="title">DemoDao</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate jt;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(DemoBean demo)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql = <span class="string">"insert into testTable values(?,?)"</span>;</span><br><span class="line">		jt.update(sql,demo.getId(),demo.getName());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql = <span class="string">"delete from testTable where id =?"</span>;</span><br><span class="line">		jt.update(sql, id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(DemoBean demo)</span> </span>&#123;</span><br><span class="line">		String sql=<span class="string">"update testTable set id=? ,name=?"</span>;</span><br><span class="line">		jt.update(sql, demo.getId(), demo.getName());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> DemoBean <span class="title">getByiD</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql =<span class="string">"select * from testTable where id=?"</span>;</span><br><span class="line">		<span class="keyword">return</span> jt.queryForObject(sql, <span class="keyword">new</span> RowMapper&lt;DemoBean&gt;()&#123;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> DemoBean <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> arg1)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">				DemoBean demo = <span class="keyword">new</span> DemoBean();</span><br><span class="line">				demo.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">				demo.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">				<span class="keyword">return</span> demo;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;, id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">totalCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select count(*) from testTable"</span>;</span><br><span class="line">		<span class="keyword">return</span> jt.queryForObject(sql, Integer.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;DemoBean&gt; <span class="title">getAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select * from testTable"</span>;</span><br><span class="line">		<span class="keyword">return</span> jt.query(sql, <span class="keyword">new</span> RowMapper&lt;DemoBean&gt;()&#123;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> DemoBean <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> arg1)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">				DemoBean demo = <span class="keyword">new</span> DemoBean();</span><br><span class="line">				demo.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">				demo.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">				<span class="keyword">return</span> demo;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="将连接池、JDBC模板、dao配置到spring"><a href="#将连接池、JDBC模板、dao配置到spring" class="headerlink" title="将连接池、JDBC模板、dao配置到spring"></a>将连接池、JDBC模板、dao配置到spring</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql:///test"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"WZhe941127"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"jdbcTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"demoDao"</span> <span class="attr">class</span>=<span class="string">"test.DemoDaoImpl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jt"</span> <span class="attr">ref</span>=<span class="string">"jdbcTemplate"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：连接池的类名不要弄错。若要自动补全，不能datasource然后补全，不然会找不到这个类。要combopooled再自动补全，就找到这个类了。property的name必须要与类中的一致，并不是起标识作用而能乱设的。</p>
<h2 id="JdbcDaoSupport"><a href="#JdbcDaoSupport" class="headerlink" title="JdbcDaoSupport"></a>JdbcDaoSupport</h2><p>这个类中封装了jdbcTemplate，根据连接池来创建jdbcTemplate。DaoImpl若继承了它，便不用手动准备jdbcTemplate,可以直接通过super.getJdbcTemplate()来获得。只要准备一个连接池就好了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之前所有的jt都变成了实时的super.getJdbcTemplate()</span></span><br><span class="line"><span class="comment">//不用设置dataSource属性，因为JdbcDaoSupport类中已经有了，只要记得在配置文件中设置dataSource属性即可。</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoDaoImpl</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">DemoDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(DemoBean demo)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql = <span class="string">"insert into testTable values(?,?)"</span>;</span><br><span class="line">		<span class="keyword">super</span>.getJdbcTemplate().update(sql,demo.getId(),demo.getName());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql = <span class="string">"delete from testTable where id =?"</span>;</span><br><span class="line">		<span class="keyword">super</span>.getJdbcTemplate().update(sql, id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(DemoBean demo)</span> </span>&#123;</span><br><span class="line">		String sql=<span class="string">"update testTable set id=? ,name=?"</span>;</span><br><span class="line">		<span class="keyword">super</span>.getJdbcTemplate().update(sql, demo.getId(), demo.getName());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> DemoBean <span class="title">getByiD</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String sql =<span class="string">"select * from testTable where id=?"</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getJdbcTemplate().queryForObject(sql, <span class="keyword">new</span> RowMapper&lt;DemoBean&gt;()&#123;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> DemoBean <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> arg1)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">				DemoBean demo = <span class="keyword">new</span> DemoBean();</span><br><span class="line">				demo.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">				demo.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">				<span class="keyword">return</span> demo;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;, id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">totalCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select count(*) from testTable"</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getJdbcTemplate().queryForObject(sql, Integer.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;DemoBean&gt; <span class="title">getAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String sql = <span class="string">"select * from testTable"</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getJdbcTemplate().query(sql, <span class="keyword">new</span> RowMapper&lt;DemoBean&gt;()&#123;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> DemoBean <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> arg1)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">				DemoBean demo = <span class="keyword">new</span> DemoBean();</span><br><span class="line">				demo.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">				demo.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">				<span class="keyword">return</span> demo;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="读取properties文件"><a href="#读取properties文件" class="headerlink" title="读取properties文件"></a>读取properties文件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 以读取数据库配置为例 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定properties文件位置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 取值用$符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driverClass&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.jdbcUrl&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.user&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="spring事务管理"><a href="#spring事务管理" class="headerlink" title="spring事务管理"></a>spring事务管理</h1><p>Spring内部封装了事务管理的代码。针对不同的操作数据库的框架，spring提供了一个统一的PlatformTransactionManager接口。在接口下有三个实现类：</p>
<ol>
<li>DataSourceTransactionManager</li>
<li>HibernateTransactionManager</li>
<li>Mybatis…</li>
</ol>
<h2 id="可选事务属性"><a href="#可选事务属性" class="headerlink" title="可选事务属性"></a>可选事务属性</h2><ol>
<li>隔离级别<ol>
<li>读未提交——1</li>
<li>读已提交——2</li>
<li>可重复读——4</li>
<li>串行化——8</li>
</ol>
</li>
<li>是否只读<ol>
<li>true——只读</li>
<li>False——不只读（默认）</li>
</ol>
</li>
<li>传播行为：业务（Service）方法之间调用时，事务应该如何处理，有七个值，只使用REQUIRED（默认）:支持当前事务，若不存在，就新建一个。如A方法调用B方法时，若A已经开启了事务，则B就用A的事务。若A没开启事务，则B开启事务。</li>
</ol>
<h2 id="管理事务方式"><a href="#管理事务方式" class="headerlink" title="管理事务方式"></a>管理事务方式</h2><h3 id="编码式（了解）"><a href="#编码式（了解）" class="headerlink" title="编码式（了解）"></a>编码式（了解）</h3><h3 id="xml配置（aop）"><a href="#xml配置（aop）" class="headerlink" title="xml配置（aop）"></a>xml配置（aop）</h3><ol>
<li><p>导包</p>
</li>
<li><p>导入新的约束（tx）</p>
</li>
<li><p>配置事务通知</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事务核心管理器,封装了所有事务操作. 依赖于连接池 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 事务模板对象,依赖于事务核心管理器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"transactionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.support.TransactionTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">ref</span>=<span class="string">"transactionManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 要在业务层service类中添加transactionTemplate属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"tt"</span> <span class="attr">ref</span>=<span class="string">"transactionTemplate"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置事务通知 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"advice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 八大常用方法通配符 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"save*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"persist*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"remove*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"modify*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"transfer"</span> <span class="attr">isolation</span>=<span class="string">"REPEATABLE_READ"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* service.impl.*ServiceImpl.*(..))"</span> <span class="attr">id</span>=<span class="string">"txpc"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 指定切面与切入点 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"advice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"txpc"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="注解配置（aop）"><a href="#注解配置（aop）" class="headerlink" title="注解配置（aop）"></a>注解配置（aop）</h3><ol>
<li><p>导包</p>
</li>
<li><p>导入新的约束（tx）</p>
</li>
<li><p>开启使用注解管理事务</p>
<p><code>&lt;tx:annotaion-driven /&gt;</code></p>
</li>
<li><p>在业务层使用注解</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在类名上使用事务注解，类中的所有方法默认采用这种方法管理事务</span></span><br><span class="line"><span class="meta">@Transactional</span>(isolation=Isolation.REPEATABLE_READ, propagation=Propagation.REQUIRED, readOnly=<span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> AccountDaoImpl accountDao;</span><br><span class="line">	<span class="keyword">private</span> TransactionTemplate tt;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> AccountDaoImpl <span class="title">getAccountDao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> accountDao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDaoImpl accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">//在指定方法上使用事务注解，重写类名上的注解</span></span><br><span class="line">	<span class="meta">@Transactional</span>(isolation=Isolation.REPEATABLE_READ, propagation=Propagation.REQUIRED, readOnly=<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(Integer from, Integer to, Double money)</span> </span>&#123;</span><br><span class="line">		accountDao.decreaseMoney(from, money);</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">		accountDao.increaseMoney(to, money);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> TransactionTemplate <span class="title">getTt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> tt;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTt</span><span class="params">(TransactionTemplate tt)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.tt = tt;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/17/springmvc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/17/springmvc/" itemprop="url">springmvc</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-17T00:00:00+08:00">2017-11-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/" itemprop="url" rel="index"><span itemprop="name">JavaWeb基础</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/SSM框架/" itemprop="url" rel="index"><span itemprop="name">SSM框架</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="springmvc架构"><a href="#springmvc架构" class="headerlink" title="springmvc架构"></a>springmvc架构</h1><ol>
<li>用户请求</li>
<li>前端控制器(DispatcherServlet)转发请求</li>
<li>处理器映射器（HandlerMapping到spring容器中查找所有注册的Controller中是否有符合的请求映射（RequestMapping），若有，则返回相应的包名+类名+方法名（Handler）到前端控制器。</li>
<li>DispatcherServlet请求执行返回的Handler</li>
<li>处理器适配器HandlerAdapter执行Handler，并得到返回的ModelAndView,将ModelAndView交给DispatcherServlet</li>
<li>DispatherServlet拿到ModelAndView后请求解析视图</li>
<li>视图解析器ViewResolver将对应位置的jsp读取到内存当中形成View对象并返回</li>
<li>DispatcherServlet对View进行渲染视图（即将模型数据填充至视图中）。</li>
<li>DispatcherServlet响应用户</li>
</ol>
<p>开发只用配置DispatcherServlet、写Controller即可</p>
<h1 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h1><p>在web.xml中配置DispatcherServlet：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定SpringMVC配置文件 --&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- SpringMVC的配置文件的默认路径是/WEB-INF/$&#123;servlet-name&#125;-servlet.xml --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    /*: 拦截所有url，包括一般过滤器、Servlet不拦截的jsp、js、png、css等</span></span><br><span class="line"><span class="comment">    *.action:拦截以action为结尾的请求</span></span><br><span class="line"><span class="comment">    /：拦截所有url，除了jsp</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Controller:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// @RequestMapping：里面放的是请求的url，和用户请求的url进行匹配</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/itemlist.action"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">itemList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		List&lt;Item&gt; itemList = <span class="keyword">new</span> ArrayList&lt;Item&gt;();</span><br><span class="line">		</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">1</span>, <span class="string">"1华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！1"</span>));</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">2</span>, <span class="string">"2华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！2"</span>));</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">3</span>, <span class="string">"3华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！3"</span>));</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">4</span>, <span class="string">"4华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！4"</span>));</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">5</span>, <span class="string">"5华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！5"</span>));</span><br><span class="line">		itemList.add(<span class="keyword">new</span> Item(<span class="number">6</span>, <span class="string">"6华为 荣耀8"</span>, <span class="number">2399</span>, <span class="keyword">new</span> Date(<span class="number">0</span>), <span class="string">"质量好！6"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 创建ModelAndView，用来存放数据和视图</span></span><br><span class="line">		ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">		<span class="comment">// 设置数据到模型中</span></span><br><span class="line">		mav.addObject(<span class="string">"itemList"</span>, itemList);</span><br><span class="line">		<span class="comment">// 设置视图jsp，需要设置视图的物理地址</span></span><br><span class="line">		mav.setViewName(<span class="string">"/WEB-INF/jsp/itemList.jsp"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> mav;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>不要忘了在springmvc.xml中引入spring的mvc约束并开启注解配置。</p>
<h1 id="springmvc三大组件"><a href="#springmvc三大组件" class="headerlink" title="springmvc三大组件"></a>springmvc三大组件</h1><p>处理器映射器、处理器适配器、视图解析器称为springmvc的三大组件，DispatcherServlet一启动就会默认加载。配置在DispatherServlet.properties文件下。</p>
<p>默认的处理器映射器与处理器适配器虽然还能使用，但都废弃了，需要在springmvc.xml中重新配置。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置处理器映射器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置处理器适配器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>也可这样使用注解驱动来一步加载</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>视图解析器没有废弃，但可以在springmvc.xml中重新配置，来设置页面的前缀与后缀。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="单个参数绑定"><a href="#单个参数绑定" class="headerlink" title="单个参数绑定"></a>单个参数绑定</h1><p>讲的是Controller中的处理器（方法）的形参</p>
<h2 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h2><p>默认可以使用HttpServletRequest、HttpServletResponse、HttpSession、Model、ModelMap作为形参，处理器会自动接收到。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*这样便可获得网页传来的参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItem.action"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editItem</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Model model)</span> </span>&#123;</span><br><span class="line">    String id = request.getParameter(<span class="string">"id"</span>);</span><br><span class="line">    Item item = itemServiceImpl.selectItemById(Integer.parseInt(id));</span><br><span class="line"></span><br><span class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">    mav.addObject(<span class="string">"item"</span>, item);</span><br><span class="line">    mav.setViewName(<span class="string">"editItem"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mav;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="简单类型"><a href="#简单类型" class="headerlink" title="简单类型"></a>简单类型</h2><p>当请求的参数名称和处理器形参名称一致时会将请求参数与形参进行绑定。</p>
<p>这样，从Request取参数的方法就可以进一步简化。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItem.action"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editItem</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//String id = request.getParameter("id");</span></span><br><span class="line">    Item item = itemServiceImpl.selectItemById(id);</span><br><span class="line"></span><br><span class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">    mav.addObject(<span class="string">"item"</span>, item);</span><br><span class="line">    mav.setViewName(<span class="string">"editItem"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mav;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="POJO"><a href="#POJO" class="headerlink" title="POJO"></a>POJO</h2><p>要求：pojo对象中的属性名和表单中input的name属性一致。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/updateItem.action"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">updateItem</span><span class="params">(Item item)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//String id = request.getParameter("id");</span></span><br><span class="line">		itemServiceImpl.updateItem(item);</span><br><span class="line">		List&lt;Item&gt; itemList = itemServiceImpl.getItemList();</span><br><span class="line">		</span><br><span class="line">		ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">		mav.addObject(<span class="string">"itemList"</span>, itemList);</span><br><span class="line">		mav.setViewName(<span class="string">"itemList"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> mav;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解决post乱码问题"><a href="#解决post乱码问题" class="headerlink" title="解决post乱码问题"></a>解决post乱码问题</h3><p><strong>注意：</strong>此时从表单中获得的数据有可能会造成乱码，可在web.xml中进行编码配置</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="解决get乱码问题"><a href="#解决get乱码问题" class="headerlink" title="解决get乱码问题"></a>解决get乱码问题</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String username = <span class="keyword">new</span> String(request.getparameter(<span class="string">"username"</span>).getBytes(<span class="string">"ISO8859-1"</span>),<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="包装的POJO"><a href="#包装的POJO" class="headerlink" title="包装的POJO"></a>包装的POJO</h2><p>包装对象为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Item item;</span><br><span class="line">	set/get。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>则在页面中的input元素，其name为item.xxx就可接收。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>商品id<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"item.id"</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>商品名称<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"item.name"</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/queryItem"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">queryItem</span><span class="params">(QueryVo queryVo)</span> </span>&#123;</span><br><span class="line">  System.out.println(queryVo.getItem().getId());</span><br><span class="line">  System.out.println(queryVo.getItem().getName());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自定义参数"><a href="#自定义参数" class="headerlink" title="自定义参数"></a>自定义参数</h2><p>由于日期数据有很多种格式，springmvc（准确地来说是处理器适配器）没办法把所有形式的字符串都准确地转换成日期类型。所以需要自定义参数。在参数绑定之前，所有参数都会经过一遍转换器，符合转换器转换格式的将进行转换。</p>
<ol>
<li><p>在converter包下构造转化器converter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//由String类型转换为Date类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>, <span class="title">Date</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">convert</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		DateFormat dateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy_MM:dd HH-mm--ss"</span>);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Date date = dateFormat.parse(str);</span><br><span class="line">			<span class="keyword">return</span> date;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">			System.out.println(<span class="string">"format error"</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		不符合格式就不转换</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在配置适配器处配置converter</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">"conversionService"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- 在转换器工厂中可以配置很多转化器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conversionService"</span> <span class="attr">class</span>=<span class="string">"org.springframework.format.support.FormattingConversionServiceFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"converters"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dateConverter"</span> <span class="attr">class</span>=<span class="string">"cn.converter.DateConverter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="集合参数绑定"><a href="#集合参数绑定" class="headerlink" title="集合参数绑定"></a>集合参数绑定</h1><p>当用到页面中的checkbox多选框时，需要用数组或集合来接收绑定参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$&#123;itemList &#125;"</span> <span class="attr">var</span>=<span class="string">"item"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"ids"</span> <span class="attr">value</span>=<span class="string">"$&#123;item.id &#125;"</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;item.name &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;item.price &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">fmt:formatDate</span> <span class="attr">value</span>=<span class="string">"$&#123;item.createtime&#125;"</span> <span class="attr">pattern</span>=<span class="string">"yyyy-MM-dd HH:mm:ss"</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;item.detail &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/editItem.action?id=$&#123;item.id&#125;"</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>只需让数组名与checkbox的name一致即可接受。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/deleteItems.action"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteItems</span><span class="params">(Integer[] ids)</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="List-有错误"><a href="#List-有错误" class="headerlink" title="List(有错误)"></a>List(有错误)</h2><p>若用list接受，则list必须为包装类的一个属性.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;Integer&gt; ids;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实际上是由QueryVo内部的list接收参数</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/deleteItems.action"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteItems</span><span class="params">(QueryVo vo)</span> </span>&#123;</span><br><span class="line">  System.out.println(vo.getIds());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而input的name应该如此设置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"itemList[$&#123;s.index&#125;].id"</span> <span class="attr">value</span>=<span class="string">"$&#123;item.id &#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="RequestMapping的使用"><a href="#RequestMapping的使用" class="headerlink" title="@RequestMapping的使用"></a>@RequestMapping的使用</h1><h2 id="method属性"><a href="#method属性" class="headerlink" title="method属性"></a>method属性</h2><p>method = RequestMethod.POST，则请求只能为post</p>
<p>method = {RequestMethod.POST, RequestMethod.GET}，则请求可以为get与post</p>
<p>不写，则默认为所有方法都可以</p>
<h2 id="窄化路径"><a href="#窄化路径" class="headerlink" title="窄化路径"></a>窄化路径</h2><p>若在Controller（类）上面添加此注解，则要求所有方法的url请求都得加上同一个前缀。</p>
<p>这样便可以对url进行分类管理</p>
<h2 id="多路径访问"><a href="#多路径访问" class="headerlink" title="多路径访问"></a>多路径访问</h2><p>每个方法可以有多个url映射，因为value属性的值可以是String数组。</p>
<h1 id="Controller层方法返回值"><a href="#Controller层方法返回值" class="headerlink" title="Controller层方法返回值"></a>Controller层方法返回值</h1><ol>
<li><p>ModelAndView</p>
<p>ModelAndView带着数据并返回视图路径</p>
</li>
<li><p>String</p>
<p>形参中要有Model或ModelMap，Model或ModelMap带数据，返回String返回视图路径。官方推荐此种方式，因为其满足解耦思想，即数据与视图分离。</p>
<p>视图路径String写法：</p>
<p>​    1.指定逻辑视图名，通过视图解析器解析为物理视图地址</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"editItem"</span>;</span><br></pre></td></tr></table></figure>
<p>​    2.重定向：”redirect:url”。此处url必须为完整页面地址，不会经过视图解析器解析，或者继续到另一个方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"forward:/WEB-INF/jsp/editItem.jsp"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="string">"forward:/example.action"</span>;</span><br></pre></td></tr></table></figure>
<p>​    3.内部转发：”forward:url”。此处url必须为完整页面地址，不会经过视图解析器解析，或者继续到另一个方法。</p>
</li>
<li><p>void</p>
<p>形参中要有Model或ModelMap，HttpServletRequest, HttpServletResponse。Model或ModelMap带数据，用request或response的转发或重定向来实现页面跳转。</p>
<p>但此种方式一般都不用来实现页面跳转，一般是用于处理ajax异步请求，只用处理json类型的数据且不用回调。</p>
</li>
</ol>
<h1 id="异常处理器"><a href="#异常处理器" class="headerlink" title="异常处理器"></a>异常处理器</h1><p>在三层架构中遇到的运行时异常都会自动向上抛出，抛到DispatcherServlet。而编译时异常与自己throw的异常（统称为预期异常）也会一直抛到DispatcherServlet。DispatcherServlet将异常交予异常处理器。springmvc有异常处理器的接口HandlerExceptionResolver，而我们只用实现接口并将实现类配置。与自定义参数时所使用的转换器一个道理，只是配置方式有所不同，异常处理器直接实例化就可。</p>
<p>接口实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExceptionResolver</span> <span class="keyword">implements</span> <span class="title">HandlerExceptionResolver</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Object arg2为异常发生的位置，包名.类名.方法名</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveException</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2,</span></span></span><br><span class="line"><span class="function"><span class="params">			Exception arg3)</span> </span>&#123;</span><br><span class="line">		ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">		mav.addObject(<span class="string">"error"</span>, <span class="string">"未知异常"</span>);</span><br><span class="line">		mav.setViewName(<span class="string">"error"</span>);</span><br><span class="line">		<span class="keyword">return</span> mav;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>springmvc.xml配置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 开启全局异常处理器 --&gt;</span><br><span class="line">&lt;bean id="customExceptionResolver" class="cn.exception.MyExceptionResolver"&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<h1 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h1><h2 id="配置tomcat虚拟目录"><a href="#配置tomcat虚拟目录" class="headerlink" title="配置tomcat虚拟目录"></a>配置tomcat虚拟目录</h2><p>双击tomcat，在Modules下加入Path：/pic，Document Base设置为/Users/h/Desktop/pic。访问<a href="http://localhost:8080/pic即可访问/Users/h/Desktop/pic下的图片。" target="_blank" rel="noopener">http://localhost:8080/pic即可访问/Users/h/Desktop/pic下的图片。</a></p>
<h2 id="指定form的enctype属性"><a href="#指定form的enctype属性" class="headerlink" title="指定form的enctype属性"></a>指定form的enctype属性</h2><p>上传文件时form需要指定属性 enctype=”multipart/form-data”</p>
<h2 id="加入上传文件的两个jar包"><a href="#加入上传文件的两个jar包" class="headerlink" title="加入上传文件的两个jar包"></a>加入上传文件的两个jar包</h2><h2 id="springmvc配置”文件上传”解析器"><a href="#springmvc配置”文件上传”解析器" class="headerlink" title="springmvc配置”文件上传”解析器"></a>springmvc配置”文件上传”解析器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传,id必须设置为multipartResolver</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置文件上传大小，以B为单位 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"5000000"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样，容器中就会生成MultipartFile接口的实现类。便可在Controller的处理器中使用。</p>
<h2 id="实现MultipartFile接口"><a href="#实现MultipartFile接口" class="headerlink" title="实现MultipartFile接口"></a>实现MultipartFile接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现类的名字必须要与网页中&lt;input type="file" name="pictureFile"&gt;的name相同	</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/updateItem.action"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updateItem</span><span class="params">(Item item, MultipartFile pictureFile)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">     	<span class="comment">//获取文件的全名</span></span><br><span class="line">	String filename = pictureFile.getOriginalFilename();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//以UUID形式保存，UUID是36个字符+四个'-'</span></span><br><span class="line">	String name = UUID.randomUUID().toString().replaceAll(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">	<span class="comment">//用FilenameUtils获取文件名后缀</span></span><br><span class="line">	String ext = FilenameUtils.getExtension(filename);</span><br><span class="line">	</span><br><span class="line">     	<span class="comment">//保存到磁盘上</span></span><br><span class="line">	pictureFile.transferTo(<span class="keyword">new</span> File(<span class="string">"/Users/h/Desktop/pic/"</span> + name + <span class="string">"."</span> + ext));</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//因为网页上的图片是file类型，而item中的pic属性为String类型，只保存文件名，因此这两个对不上号，pic属性就可以我们自己来设置。</span></span><br><span class="line">	item.setPic(name + <span class="string">"."</span> + ext);</span><br><span class="line">	itemServiceImpl.updateItem(item);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:/editItem.action?id="</span> + item.getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="json数据交互"><a href="#json数据交互" class="headerlink" title="json数据交互"></a>json数据交互</h1><h2 id="RequestBody与-ResponseBody"><a href="#RequestBody与-ResponseBody" class="headerlink" title="@RequestBody与@ResponseBody"></a>@RequestBody与@ResponseBody</h2><p>@RequestBody注解用于读取http请求的内容(字符串)，通过springmvc提供的HttpMessageConverter接口将读到的内容（json数据）转换为java对象并绑定到Controller方法的参数上。</p>
<p>@ResponseBody注解用于将Controller的方法返回的对象，通过springmvc提供的HttpMessageConverter接口转换为指定格式的数据如：json,xml等，通过Response响应给客户端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只要json字符串中的数据key与item中的属性名相同，value就会自动封装到item的属性中。</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/json.action"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">Item <span class="title">json</span><span class="params">(@RequestBody Item item)</span> </span>&#123;</span><br><span class="line">    System.out.println(item);</span><br><span class="line">  	<span class="comment">//返回item,springmvc会自动将其解析成json回调给ajax引擎</span></span><br><span class="line">    <span class="keyword">return</span> item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="json交互方式"><a href="#json交互方式" class="headerlink" title="json交互方式"></a>json交互方式</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  	<span class="comment">//json字符串一定是json格式再加字符串</span></span><br><span class="line">	<span class="keyword">var</span> params = <span class="string">'&#123;"id":4, "name":"试试json", "price":5000, "detail":"meiyou","pic": "123456.jpg"&#125;'</span></span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url : <span class="string">"$&#123;pageContext.request.contextPath&#125;/json.action"</span>,  <span class="comment">//服务器得到的请求</span></span><br><span class="line">      	type : <span class="string">"post"</span>,	<span class="comment">//所得请求的方式</span></span><br><span class="line">		data : params,	<span class="comment">//服务器得到的数据</span></span><br><span class="line">		contentType : <span class="string">"application/json;charset=UTF-8"</span>,	<span class="comment">//得到的数据格式</span></span><br><span class="line">		dataType : <span class="string">"json"</span>,<span class="comment">//回调的数据格式</span></span><br><span class="line">		success : <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">			alert(data.name);</span><br><span class="line">		&#125;<span class="comment">//回调后所执行的方法，这里的data是服务器回调的数据</span></span><br><span class="line">	&#125;);</span><br><span class="line">	</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><p>实现拦截器接口后有三个方法，分别作用于Controller层方法执行前、Controller层方法执行后、视图解析（页面渲染）后。</p>
<h2 id="配置拦截器"><a href="#配置拦截器" class="headerlink" title="配置拦截器"></a>配置拦截器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 拦截所有请求 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">"myInterceptor"</span> <span class="attr">class</span>=<span class="string">"cn.interceptor.MyInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="实现拦截器接口"><a href="#实现拦截器接口" class="headerlink" title="实现拦截器接口"></a>实现拦截器接口</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"pre"</span>);</span><br><span class="line">		<span class="comment">//return的值决定放行或不放行</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, ModelAndView arg3)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"post"</span>);		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, Exception arg3)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"after"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="拦截器的执行顺序"><a href="#拦截器的执行顺序" class="headerlink" title="拦截器的执行顺序"></a>拦截器的执行顺序</h1><p>preHandle按拦截器定义顺序调用</p>
<p>postHandler按拦截器定义逆序调用</p>
<p>afterCompletion按拦截器定义逆序调用</p>
<p>postHandler在拦截器链内所有拦截器返成功调用</p>
<p>afterCompletion只用preHandle返回true就可以调用</p>
<h1 id="加载静态资源"><a href="#加载静态资源" class="headerlink" title="加载静态资源"></a>加载静态资源</h1><p>web.xml配置时，若设置所有的请求都进入SpringMVC，则加载css、js时也会先进入SpringMVC，但SpringMVC无法处理，导致页面不能正常显示。因此要将请求限定为以action结尾。</p>
<h1 id="在controller层读取properties文件"><a href="#在controller层读取properties文件" class="headerlink" title="在controller层读取properties文件"></a>在controller层读取properties文件</h1><p>可解决controller层的部分硬编码问题</p>
<p>先在springmvc.xml中进行配置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:env.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>便可以在controller层进行赋值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;CUSTOMER_FROM_TYPE&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String CUSTOMER_FROM_TYPE;</span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;CUSTOMER_FROM_TYPE&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String CUSTOMER_INDUSTRY_TYPE;</span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"&#123;CUSTOMER_LEVEL_TYPE&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String CUSTOMER_LEVEL_TYPE;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>applicationContext.xml中也有<context:property-placeholder>标签，整个环境中这个标签只能指向一个配置文件。因此要把db.properties中的配置都转移到env.properties中去。    </context:property-placeholder></p>
<h1 id="Springmvc与Struts2的区别"><a href="#Springmvc与Struts2的区别" class="headerlink" title="Springmvc与Struts2的区别"></a>Springmvc与Struts2的区别</h1><p>1、springmvc的入口是一个servlet即前端控制器，而struts2入口是一个filter过滤器。</p>
<p>2、springmvc是基于方法开发(一个url对应一个方法)，请求参数传递到方法的形参，可以设计为单例或多例(建议单例)，struts2是基于类开发，传递参数是通过类的属性，只能设计为多例。</p>
<p>3、Struts采用值栈存储请求和响应的数据，通过OGNL存取数据， springmvc通过参数解析器是将request请求内容解析，并给方法形参赋值，将数据和视图封装成ModelAndView对象，最后又将ModelAndView中的模型数据通过request域传输到页面。Jsp视图解析器默认使用jstl。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/17/mybatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/17/mybatis/" itemprop="url">mybatis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-17T00:00:00+08:00">2017-11-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/" itemprop="url" rel="index"><span itemprop="name">JavaWeb基础</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/SSM框架/" itemprop="url" rel="index"><span itemprop="name">SSM框架</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mybatis架构"><a href="#mybatis架构" class="headerlink" title="mybatis架构"></a>mybatis架构</h1><ol>
<li>核心配置文件：SqlMapConfig.xml</li>
<li>数据库映射文件：MapperN.xml</li>
<li>由xml文件产生SqlSessionFactory</li>
<li>SqlSessionFactory产生SqlSession</li>
<li>调用SqlSession中的Executor</li>
<li>调用Executor中的MappedStatement存储sql语句的各字段成分</li>
<li>再返回来由Executor执行</li>
</ol>
<p>5-7是底层</p>
<h1 id="框架搭建"><a href="#框架搭建" class="headerlink" title="框架搭建"></a>框架搭建</h1><ol>
<li><p>导包</p>
</li>
<li><p>创建SqlMapConfig.xml并赋予dtd约束</p>
</li>
<li><p>创建log4j.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mapper包，里面写动态代理实现Dao层的Mapper接口与对应的Mapper.xml，赋予dtd约束并告知SqlMapConfig.xml，注意两者的前缀要一致。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 指定Mapper.xml的包名</span></span><br><span class="line"><span class="comment">	   将各个pojo的Mapper.xml放在mapper包下，mybatis会自动注册包下的所有mapper接口，并将包下名称前缀相同的mapper接口与xml关联在一起。如UserMapper.java与UserMapper.xml</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="基本代码"><a href="#基本代码" class="headerlink" title="基本代码"></a>基本代码</h1></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取配置文件</span></span><br><span class="line">String resource = <span class="string">"classpath:SqlMapConfig.xml"</span>;</span><br><span class="line">InputStream in = Resources.getResourceAsStream(resource);</span><br><span class="line"></span><br><span class="line"><span class="comment">//SqlSessionFactoryBuilder   build   sqlSessionFactory</span></span><br><span class="line">SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line"></span><br><span class="line"><span class="comment">//SqlSessionFactory产生SqlSession</span></span><br><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line"><span class="comment">//SqlSession与数据库交互</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//手动提交事务</span></span><br><span class="line">session.commit();</span><br></pre></td></tr></table></figure>
<h1 id="数据库交互代码"><a href="#数据库交互代码" class="headerlink" title="数据库交互代码"></a>数据库交互代码</h1><h2 id="查询（单个）（底层）"><a href="#查询（单个）（底层）" class="headerlink" title="查询（单个）（底层）"></a>查询（单个）（底层）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user = session.selectOne(<span class="string">"test.getUserById"</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// 第一个参数是User.xml的statement的id，第二个参数是执行sql需要的参数；</span></span><br></pre></td></tr></table></figure>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">parameterType</span>=<span class="string">"Integer"</span> <span class="attr">resultType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- #&#123;v&#125;为占位符？ 其中，大括号内可以为任意值，不一定是v--&gt;</span></span><br><span class="line">		select * from user where id = #&#123;v&#125;		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="查询（多个）（底层）"><a href="#查询（多个）（底层）" class="headerlink" title="查询（多个）（底层）"></a>查询（多个）（底层）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Object&gt; list = session.selectList(<span class="string">"test.getUserByName"</span>, <span class="string">"王五"</span>);</span><br></pre></td></tr></table></figure>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注意：虽然返回的是List,但是resultType还是单个User --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 占位符是#&#123;..&#125;</span></span><br><span class="line"><span class="comment">	 而字符串拼接是'$&#123;value&#125;'，且大括号里面必须是value</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByName"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span> <span class="attr">resultType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line">		select * from user where username like '%$&#123;value&#125;%'		</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Mapper.xml还可如下配置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用#&#123;..&#125;来进行字符串拼接 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByName"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span> <span class="attr">resultType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line">		select * from user where username like "%"#&#123;suibian&#125;"%"	</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="增（底层）"><a href="#增（底层）" class="headerlink" title="增（底层）"></a>增（底层）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session.insert(<span class="string">"test.insertUser"</span>, user);</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入后自动返回相应id到user中</span></span><br><span class="line">syso(user.getId())</span><br></pre></td></tr></table></figure>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertUser"</span> <span class="attr">parameterType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用selectKey元素，可以在插入后返回数据库中相应的某字段到user中 </span></span><br><span class="line"><span class="comment">		keyProperty为属性值</span></span><br><span class="line"><span class="comment">		resultType为返回类型</span></span><br><span class="line"><span class="comment">		order指在mysql中自动生成的id，是在其它字段插入完成后再自动生成</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">resultType</span>=<span class="string">"Integer"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span>&gt;</span></span><br><span class="line">			select LAST_INSERT_ID()</span><br><span class="line">	<span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">		insert into user(username, sex, birthday, address) values(#&#123;username&#125;, #&#123;sex&#125;, #&#123;birthday&#125;, #&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="删（底层）"><a href="#删（底层）" class="headerlink" title="删（底层）"></a>删（底层）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.delete(<span class="string">"test.deleteUserById"</span>, <span class="number">27</span>);</span><br></pre></td></tr></table></figure>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUserById"</span> <span class="attr">parameterType</span>=<span class="string">"Integer"</span>&gt;</span></span><br><span class="line">		delete from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="改（底层）"><a href="#改（底层）" class="headerlink" title="改（底层）"></a>改（底层）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.update(<span class="string">"test.updateUserById"</span>, user);</span><br></pre></td></tr></table></figure>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUserById"</span> <span class="attr">parameterType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line">		update user set username=#&#123;username&#125;, sex=#&#123;sex&#125;, birthday=#&#123;birthday&#125;, address=#&#123;address&#125; where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="mybatis与hibernate的不同"><a href="#mybatis与hibernate的不同" class="headerlink" title="mybatis与hibernate的不同"></a>mybatis与hibernate的不同</h1><ol>
<li>mybatis不完全是ORM框架，因为它要自己写SQL语句</li>
<li>mybatis比较简单，但无法做到数据库无关性，即没有数据库方言选项，一旦从mysql变成了oracle,它的sql语句就要变化。</li>
<li>mybatis适合对关系数据模型要求不高的软件开发</li>
</ol>
<h1 id="Dao层动态代理开发"><a href="#Dao层动态代理开发" class="headerlink" title="Dao层动态代理开发"></a>Dao层动态代理开发</h1><h2 id="Mapper接口"><a href="#Mapper接口" class="headerlink" title="Mapper接口"></a>Mapper接口</h2><p>只写一个接口，取代以前Dao和DaoImpl</p>
<p>遵循四个原则：</p>
<ol>
<li><p>Mapper.xml的命名空间是此接口的完整类名</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"mapper.UserMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"></span><br><span class="line">这样，接口的实现类在执行方法时就会到这里来寻找对应的操作。</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法名与Mapper.xml中操作的id保持一致</p>
</li>
<li><p>方法的返回值与Mapper.xml中操作的resultType保持一致</p>
</li>
<li><p>方法的入参要与Mapper.xml中操作的parameterType保持一致</p>
</li>
</ol>
<p><strong>注意：</strong>SqlSession执行selectOne还是selectList，它会自行根据方法的返回值进行判断。</p>
<h2 id="dao层实现"><a href="#dao层实现" class="headerlink" title="dao层实现"></a>dao层实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">User user = mapper.getUserById(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><ol>
<li>session拿已有的接口创建Mapper实现类</li>
<li>mapper实现类调用特定方法，通过sqlmap中的namespace找到对应配置文件</li>
<li>执行与方法名相同的操作</li>
</ol>
<h1 id="核心配置-SqlMapConfig-xml-属性"><a href="#核心配置-SqlMapConfig-xml-属性" class="headerlink" title="核心配置(SqlMapConfig.xml)属性"></a>核心配置(SqlMapConfig.xml)属性</h1><p><strong>注意：</strong>以下属性为元素的先后顺序</p>
<h2 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h2><p>读取properties配置文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"log4j.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="typeAliases"><a href="#typeAliases" class="headerlink" title="typeAliases"></a>typeAliases</h2><p>设置配置文件（包括SqlMapConfig.xml与sqlmap中的User.xml）中类型的别名</p>
<h3 id="单个类型设置"><a href="#单个类型设置" class="headerlink" title="单个类型设置"></a>单个类型设置</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"pojo.User"</span> <span class="attr">alias</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样的话，一个类型就要一个元素，因此推荐下面的设置</p>
<h3 id="包设置"><a href="#包设置" class="headerlink" title="包设置"></a>包设置</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 只指定pojo包，则其中所有的pojo都会被扫描到，且其别名与类名相同</span></span><br><span class="line"><span class="comment">	 如User对应的别名是User与user</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"pojo"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="mappers"><a href="#mappers" class="headerlink" title="mappers"></a>mappers</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 指定Mapper.xml的包名</span></span><br><span class="line"><span class="comment">	   将各个pojo的Mapper.xml放在mapper包下，mybatis会自动注册包下的所有mapper接口，并将包下名称前缀相同的mapper接口与xml关联在一起。如UserMapper.java与UserMapper.xml</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="输入参数映射之POJO包装类"><a href="#输入参数映射之POJO包装类" class="headerlink" title="输入参数映射之POJO包装类"></a>输入参数映射之POJO包装类</h1><p>假设User对象同时是某对象（如QueryVo）的成员变量，若以QueryVo对象为输入参数，则相关Mapper.xml中配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByQueryVo"</span> <span class="attr">parameterType</span>=<span class="string">"pojo.QueryVo"</span> <span class="attr">resultType</span>=<span class="string">"pojo.User"</span>&gt;</span></span><br><span class="line">	select * from user where username like "%"#&#123;user.username&#125;"%"	</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>同时在接口中要有getUserByQueryVo对应的方法。</p>
<h1 id="输出参数映射之resultMap"><a href="#输出参数映射之resultMap" class="headerlink" title="输出参数映射之resultMap"></a>输出参数映射之resultMap</h1><p>若pojo的属性名称与mysql的字段名称不一样，可以通过resultMap将字段名和属性名作一个对应关系，将查询结果映射为复杂类型的pojo。</p>
<p>在Mapper.xml中如下配置</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- select元素中的resultMap属性值要与resultMap元素的id值相同</span></span><br><span class="line"><span class="comment">	type指定pojo</span></span><br><span class="line"><span class="comment">	result元素用来指名映射，即从数据库中获得的user_id字段要放到Order类的userId属性中去</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"order"</span> <span class="attr">type</span>=<span class="string">"pojo.Order"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">column</span>=<span class="string">"user_id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"orderList"</span> <span class="attr">resultMap</span>=<span class="string">"order"</span>&gt;</span></span><br><span class="line">	select * from orders</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h1><p>设定QueryVo下有可迭代属性，如</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Integer[] idarray;</span><br><span class="line"><span class="keyword">private</span> List&lt;Integer&gt; idlist;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByIds"</span> <span class="attr">parameterType</span>=<span class="string">"QueryVo"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line">  <span class="comment">&lt;!-- where可以忽略where内部的第一个放在语句前的and --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    id in</span><br><span class="line">  <span class="comment">&lt;!-- 使idlist中提取出来的123变成(1,2,3) --&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"idlist"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- if标签必须要有test属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id &gt;=10"</span>&gt;</span></span><br><span class="line">		#&#123;id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>若输入参数不为QueryVo，而是直接将集合或者数组放入，则parameterType应为Integer, collection应固定为list或者array，否则会报错。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByIds"</span> <span class="attr">parameterType</span>=<span class="string">"Integer"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">		select * from user</span><br><span class="line">			<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">				id in</span><br><span class="line">				<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">				#&#123;id&#125;</span><br><span class="line">				<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h1><p>一对一的情况即一个pojo中对应另一个pojo对象，此处以Order对应一个User为例</p>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- resultMap中，主键元素，即id元素可以不进行映射 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"orders"</span> <span class="attr">type</span>=<span class="string">"pojo.Order"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- &lt;id property="id" column="id"/&gt; --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">column</span>=<span class="string">"user_id"</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 一对一标签association，对象属性的javaType不可以省略 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">javaType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;id property="id" column="id"/&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOrderList"</span> <span class="attr">resultMap</span>=<span class="string">"orders"</span>&gt;</span></span><br><span class="line">  select o.id, o.user_id, o.number, o.createtime, o.note, u.username from orders o left join user u on o.user_id = u.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h1><p>一对多的情况即一个pojo中对应另一个pojo的集合，此处以User对应多个Order为例</p>
<p>Mapper.xml配置如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"User"</span> <span class="attr">id</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 同样，主键元素可以不映射 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 一对多标签collection，javaType代表集合类型，ofType代表集合泛型 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"orders"</span> <span class="attr">javaType</span>=<span class="string">"List"</span> <span class="attr">ofType</span>=<span class="string">"Order"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"number"</span> <span class="attr">column</span>=<span class="string">"number"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">parameterType</span>=<span class="string">"Integer"</span> <span class="attr">resultMap</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  select u.id, u.username, u.birthday, u.address, u.sex, o.number from user u left join orders o on o.user_id = u.id</span><br><span class="line">  where</span><br><span class="line">  u.id = #&#123;id&#125;		</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="mybatis整合spring"><a href="#mybatis整合spring" class="headerlink" title="mybatis整合spring"></a>mybatis整合spring</h1><h2 id="整合思路"><a href="#整合思路" class="headerlink" title="整合思路"></a>整合思路</h2><p>1、SqlSessionFactory对象应该放到spring容器中作为单例存在。</p>
<p>2、传统dao的开发方式中，应该从spring容器中获得sqlsession对象。</p>
<p>3、Mapper代理形式中，应该从spring容器中直接获得mapper的代理对象。</p>
<p>4、数据库的连接以及数据库连接池事务管理都交给spring容器来完成。</p>
<h2 id="原始dao开发"><a href="#原始dao开发" class="headerlink" title="原始dao开发"></a>原始dao开发</h2><p>applicationContext.xml中配置数据源连接池、sqlSessionFactory，并将sqlSessionFactory赋予dao实现类。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置数据源连接池 --&gt;</span>	 </span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置SqlSessionFactory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:SqlMapConfig.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置dao层 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDao"</span> <span class="attr">class</span>=<span class="string">"dao.UserDaoImpl"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>dao实现类继承SqlSessionDaoSupport类，便能直接得到sqlSession</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUserById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">     	SqlSession sqlSession = <span class="keyword">this</span>.getSqlSession();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mapper动态代理开发"><a href="#mapper动态代理开发" class="headerlink" title="mapper动态代理开发"></a>mapper动态代理开发</h2><p>从代码上来看</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SqlSession sqlSession = sqlSessionFactory.openSession();	</span><br><span class="line">UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br></pre></td></tr></table></figure>
<p>mapper的获取方式是：mybatis-spring就会用MapperFactoryBean即Mapper工厂来生成相应的mapper。而生成相应的mapper需要两个条件，一是sqlSessionFactory，用来生成sqlSession；二是Mapper接口用来指定Mapper的类型。配置如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置userMapper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userMapper"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperInterface"</span> <span class="attr">value</span>=<span class="string">"mapper.UserMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其实就是用配置来封装了上面的两行代码。这样便可直接通过<code>getBean(&quot;userMapper&quot;)来获取到Mapper</code></p>
<h3 id="动态代理扫描开发"><a href="#动态代理扫描开发" class="headerlink" title="动态代理扫描开发"></a>动态代理扫描开发</h3><p>若一个业务一个mapper接口，则上面的配置就会有许多冗余。mybatis-spring提供MapperScannerConfigurer类，可以用来扫描指定的基本包下的所有mapper接口，并且不用有id，因为它是在基本包中查找。不用在其中配置SqlSessionFactory，它会自动在容器中找到。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mapper动态代理扫描开发 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 扫描mapper基本包下的所有mapper接口 --&gt;</span>	</span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"mappper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>但这种情况的Dao层，不能用名称来获取Bean，而是用class。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  ApplicationContext ac =<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">  <span class="comment">//spring获得UserMapper.class后，便知道了包名，就会在包下扫描到UserMapper接口</span></span><br><span class="line">  UserMapper userMapper = ac.getBean(UserMapper.class);</span><br><span class="line">  User user = userMapper.getUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/13/git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/13/git/" itemprop="url">git 基本使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-13T00:00:00+08:00">2017-11-13</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;Your Name&quot;	设置用户名</span><br><span class="line">git config --global user.email &quot;email@example.com&quot;	设置用户邮箱</span><br><span class="line">git init	创建 git 仓库</span><br><span class="line">git add	filename	把文件添加到仓库</span><br><span class="line">git commit -m &quot;somemessages&quot;	把文件提交到仓库</span><br><span class="line">git status		查看仓库的当前状态</span><br><span class="line">git diff		查看仓库的修改内容</span><br><span class="line">git log			查看日志</span><br><span class="line">git reset --hard HEAD^		回退到上个版本</span><br><span class="line">git reset --hard 3628164	回退到版本号以3628164开头的版本</span><br><span class="line">git reset HEAD fileName			把暂存区的修改撤销掉</span><br><span class="line">git reflog		查看每一条命令</span><br><span class="line">git checkout -- filename		使文件回到最近一次 commit 或者 add 时的状态</span><br><span class="line">git rm		从版本库中删除文件</span><br><span class="line">git remote add origin git@github.com:GitHubUserName/GitHubRepositoryName.git	将本地仓库与远程仓库关联，远程仓库名字为 origin</span><br><span class="line">git push -u origin master		推送本地的 master 分支，并将远程仓库中的新的 master 分支与本地的 master 分支关联起来。</span><br><span class="line">git checkout -b dev		创建并切换到dev 分支</span><br><span class="line">git checkout -b dev origin/dev		创建远程 origin 的 dev 粉猪到本地</span><br><span class="line">git branch dev		创建 dev 分支</span><br><span class="line">git checkout dev		切换到 dev 分支</span><br><span class="line">git branch		查看当前分支</span><br><span class="line">git merge dev	将 dev 分支合并到当前分支</span><br><span class="line">git branch -d dev		删除 dev 分支</span><br><span class="line">git branch -D dev		在没合并前强制删除 dev 分支</span><br><span class="line">git stash	保存当前工作现场</span><br><span class="line">git stash list	查看所有保存的工作现场</span><br><span class="line">git stash pop	恢复现场的同时删除stash内容</span><br><span class="line">git remote	查看远程库的信息</span><br><span class="line">git remote -v	查看远程库的详细信息</span><br><span class="line">git branch --set-upstream dev origin/dev	设置本地与远程的分支链接</span><br><span class="line">git pull	从远程抓取分支</span><br><span class="line">git tag v1.0	给当前分支的当前版本打上标签 v1.0</span><br><span class="line">git tag 查看所有标签</span><br><span class="line">git tag v0.9 6224937	给指定版本号打上标签</span><br><span class="line">git show tagName	显示指定标签的信息</span><br><span class="line">git tag -a v0.3 -m &quot;version 0.3 released&quot; a572025	给指定版本号打上名为 v0.3的标签，标签信息为...</span><br><span class="line">git tag -d v0.1		删除标签</span><br><span class="line">git push origin v1.0	将 v1.0标签推送到远程仓库</span><br><span class="line">git push origin --tags		将全部标签都推送到远程仓库</span><br><span class="line">git push origin :refs/tags/v0.9		删除远程仓库的 v0.9标签</span><br></pre></td></tr></table></figure>
<h2 id="关于回退："><a href="#关于回退：" class="headerlink" title="关于回退："></a>关于回退：</h2><p>场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令<code>git checkout -- file</code>。</p>
<p>场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令<code>git reset HEAD file</code>，就回到了场景1，第二步按场景1操作。</p>
<p>场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，就进行版本回退<code>git reset --hard HEAD^</code></p>
<h2 id="关于冲突："><a href="#关于冲突：" class="headerlink" title="关于冲突："></a>关于冲突：</h2><h3 id="本地："><a href="#本地：" class="headerlink" title="本地："></a>本地：</h3><p>引起冲突的原因：</p>
<p>不同的分支对相同的文件作了不同的更改，且都提交到了本地库中。则会在合并分支时产生冲突。</p>
<p>当Git无法自动合并分支时，就必须首先解决冲突。</p>
<ol>
<li><code>git status</code>查看哪个文件起的冲突</li>
<li>查看文件内容，冲突位置会被标识出来</li>
<li>将文件内容做合理修改，使所有分支提交的内容是一样的</li>
</ol>
<p>解决冲突后，再提交，就相当于完成了合并。</p>
<p>用<code>git log --graph</code>命令可以看到分支合并图。</p>
<h3 id="远程："><a href="#远程：" class="headerlink" title="远程："></a>远程：</h3><p>向远程推送分支时，有别人在自己修改的同时也做了修改并已推送，便会产生冲突。</p>
<ol>
<li><code>git branch --set-upstream dev origin/dev</code>设置本地与远程的分支链接</li>
<li><code>git pull</code>把最新的提交从远程库中抓下来，然后在本地解决冲突再推送。</li>
</ol>
<p>### </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/17/servlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/17/servlet/" itemprop="url">servlet</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-17T00:00:00+08:00">2017-08-17</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaWeb基础/" itemprop="url" rel="index"><span itemprop="name">JavaWeb基础</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Servlet接口"><a href="#Servlet接口" class="headerlink" title="Servlet接口"></a>Servlet接口</h1><p>所有的servlet都要实现Servlet接口，其中有三个非常重要的方法：</p>
<ol>
<li>init(ServletConfig):第一次调用（tomcat服务器第一次创建Servlet实例）时执行</li>
<li>service(ServletRequest,ServeltResponse):每一次调用(tomcat服务器每一次创建Servlet实例）时执行</li>
<li>destory():服务器关闭或项目移除时执行</li>
</ol>
<h1 id="web-xml相关配置"><a href="#web-xml相关配置" class="headerlink" title="web.xml相关配置"></a>web.xml相关配置</h1><ol>
<li>在<servlet></servlet>标签中可添加<load-on-startup>number标签对。  number为一个正整数，整数越小，被创建时的优先级越高。</load-on-startup></li>
<li>在<servlet></servlet>标签中可添加<init-param></init-param>标签对。此为初始参数，要放在servlet-class的后面。</li>
<li>url-pattern的配置：有完全路径匹配（以/开始）、目录匹配（以/开始，以*结束）、扩展名匹配（以*开始，加后缀）、缺省路径（只有/）四种。</li>
<li>配置文件中的元素获取顺序：url-pattern、servlet-name(mapping中的)、servlet-name(servlet中的)、servlet-class</li>
</ol>
<h1 id="目录相关"><a href="#目录相关" class="headerlink" title="目录相关"></a>目录相关</h1><p>跟tomcat服务器相关的内容，都是放在WebContent文件夹中。WebContent文件夹相当于tomcat文件夹中的webapps。</p>
<p>build文件夹相当于webapps/WEB-INF/classes文件夹。每当在src中建立任何文件，build中都会copy一份，同样，classes文件夹中也会copy一份。注意src与tomcat文件夹一点关系也没有，tomcat只需要copy src中的class。</p>
<p>其它任何与WebContent同级的文件，都是不可见的。因此任何与项目有关的文件，都要exist在WebContent.</p>
<h1 id="基本编写步骤"><a href="#基本编写步骤" class="headerlink" title="基本编写步骤"></a>基本编写步骤</h1><p>创建HttpServlet的继承类，重写doGet和doPost方法。</p>
<p>每次访问都执行doGet或doPost方法，因为在其父类或爷类中，已经将service方法的执行转变成了这两个。具体可见源码。</p>
<h1 id="ServletConfig"><a href="#ServletConfig" class="headerlink" title="ServletConfig"></a>ServletConfig</h1><p>针对每个Servlet，都会有一个ServletConfig对象。常用API：</p>
<ol>
<li>getServletName()：获取当前Servlet在xml中配置的name值</li>
<li>getInitParam(String)：获取当前Servlet的初始化参数</li>
</ol>
<h1 id="ServletContext"><a href="#ServletContext" class="headerlink" title="ServletContext"></a>ServletContext</h1><p>服务器启动时，为每个WEB应用（针对的是webapps文件夹，不是WebContent目录）创建一个单独的ServletContext对象，可以用其存取全局（在整个WEB应用范围的）数据。</p>
<pre><code>ServletContext context = this.getServletContext()  //创建ServletContext实例
ServletContext context = ServletConfig.getServletContext()  //创建ServletContext实例
</code></pre><p>ServletContext有三种功能。</p>
<h2 id="对整个web项目设置初始化数据"><a href="#对整个web项目设置初始化数据" class="headerlink" title="对整个web项目设置初始化数据"></a>对整个web项目设置初始化数据</h2><p>可以用<context-param></context-param>标签对来设置全局参数</p>
<h2 id="可以在多个servlet之间共享数据-重要"><a href="#可以在多个servlet之间共享数据-重要" class="headerlink" title="可以在多个servlet之间共享数据(重要)"></a>可以在多个servlet之间共享数据(重要)</h2><ol>
<li>setAttribute(String name, Object object):存放数据</li>
<li>getAttribute(String name):读取数据</li>
<li>removeAttribute(String name):移除数据</li>
</ol>
<h2 id="可以获得当前web项目中的指定资源-文件-重要"><a href="#可以获得当前web项目中的指定资源-文件-重要" class="headerlink" title="可以获得当前web项目中的指定资源(文件)(重要)"></a>可以获得当前web项目中的指定资源(文件)(重要)</h2><p>API：String getRealPath(String path):返回文件的绝对路径。path是指相对于webapps的路径。若不能得到绝对路径则返回null。</p>
<p>（扩展）还有一种获得绝对路径的方法：用类加载器<br>​<br>    类.class.getClassLoader().getResource(String path).getPath();</p>
<p>注意：这里的path不是相对于webapps的路径，而是相对于src的路径。</p>
<h1 id="ServletResponse-Response"><a href="#ServletResponse-Response" class="headerlink" title="ServletResponse(Response)"></a>ServletResponse(Response)</h1><h2 id="Response工作原理"><a href="#Response工作原理" class="headerlink" title="Response工作原理"></a>Response工作原理</h2><p>Response拥有一个缓冲区，service(或doGet)方法结束后，tomcat服务器会自动从缓冲区中获取内容，组装成一个http响应发送给客户端。如Response.getWriter().write()就是把文本写入缓冲区，而不是直接写给客户端。</p>
<h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><ol>
<li>setstatus(int):设置状态码，如303</li>
<li>addHeader(String name, String value):在响应头中添加字段</li>
<li>setHeader(String name, String value):在响应头中设置字段</li>
<li>sendRedirect(String path):跳转。此path相对于webapps</li>
<li>setContentType(“text/html;charset=UTF-8”):设置网页文本的编码</li>
<li>getWriter().write()：往客户端写文本</li>
</ol>
<h2 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h2><ol>
<li>首先通过<code>request.getparameter()</code>得到filename</li>
<li>再<code>filename = new String(filename.getBytes(&quot;ISO8859-1&quot;),&quot;UTF-8&quot;)</code>来防止中文文件名出现乱码</li>
<li>告知浏览器文件的类型:<code>response.setContentType(this.getServletContext().getMimeType(filename))</code></li>
<li>告知浏览器文件的打开方式是下载:<code>response.addHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot; + filenameEncoded)</code></li>
<li>获取文件绝对路径：<code>String path = this.getServletContext().getRealPath(&quot;download/&quot;+filename);</code></li>
<li>然后就是拷贝的模板，只是这里的OutputStream是通过response.getOutputStream()获得。</li>
</ol>
<p>注意：第四步中的filenameEncoded对象，是针对不同浏览器对下载的文件名称filename进行了不同的编码。</p>
<h2 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h2><p>需要有验证码Servlet以及验证码序列的txt文件。</p>
<p>将验证码图片(img)中设置的属性src指向验证码Servlet便可。</p>
<p>若要实现点击变换验证码，则要加上js语句。</p>
<h1 id="ServletRequest-Request"><a href="#ServletRequest-Request" class="headerlink" title="ServletRequest(Request)"></a>ServletRequest(Request)</h1><h2 id="Request工作原理"><a href="#Request工作原理" class="headerlink" title="Request工作原理"></a>Request工作原理</h2><p>客户端发送http请求后，tomcat会自动将请求的资源信息封装成一个request对象。</p>
<h2 id="常用API-1"><a href="#常用API-1" class="headerlink" title="常用API"></a>常用API</h2><ol>
<li>getMethod():获得请求行中的方法（GET或者POST)</li>
<li>getRequestURI():获得请求行中的URI（项目路径）</li>
<li>getRequestURL():获得请求行中的URL（全球路径）</li>
<li>getContextPath():获得项目名称（如WEB_TEST01)</li>
<li>getRemoteAddr():获得客户端的IP地址。 //客户机的IP地址在HTTP请求中，但是并没有被tomcat封装到请求行上。</li>
<li>getHeader(name):获得请求头中某名称的值</li>
<li>getParameter(name):获得提交（get或post都可以）的参数中为name的值，返回String</li>
<li>getParameterMap():将参数键值对以Map<string,string[]>的方式封装，并返回。value之所以为String[]是因为一个name可能对应多个值，如radio元素与checkbox元素</string,string[]></li>
<li>getParameterValues(name):将参数中name所对应的多个值，以String[]类型封装并返回</li>
</ol>
<p><strong>注意：客户端输入并发送的参数，到服务器端都是字符串的形式</strong></p>
<h2 id="中文乱码的解决方案"><a href="#中文乱码的解决方案" class="headerlink" title="中文乱码的解决方案"></a>中文乱码的解决方案</h2><pre><code>如何编码：str.getBytes(String charSet)例:name.getBytes(&quot;iso8859-1&quot;)
如何解码：new String(byte[],String charSet)例：new String(name.getBytes(&quot;iso8859-1&quot;),&quot;UTF-8&quot;)
</code></pre><ol>
<li><p>post提交方式</p>
<p>request.setCharacterEncoding(“UTF-8”);</p>
</li>
<li><p>get提交方式</p>
<p> name = new String(name.getBytes(“iso8859-1”),”UTF-8”);</p>
</li>
</ol>
<p><strong>注意：第一种解决方案通常适用于表单元素（form)，因为表单的提交方式几乎都是post。而第二种解决方案通常适用于单个提交元素</strong></p>
<h2 id="request域和转发"><a href="#request域和转发" class="headerlink" title="request域和转发"></a>request域和转发</h2><p>request与ServletContext一样，也是一个域对象。同样有setAttribute(name,value)与getAttribute(name)方法。这两个方法通常搭配<strong>转发</strong>使用：</p>
<pre><code>RequestDispatcher dispatcher = request.getRequestDispatcher(服务器内部路径path); //创建转发器,这里的path是相对于工程目录的，通往另一个Servlet类
dispatcher.forward(request,response);  //转发
</code></pre><p>在转发后，仍处于当前请求中，因此仍属于当前request的作用域中，可在下一个Servlet中request.getAttribute(name)</p>
<h2 id="转发与重定向的区别"><a href="#转发与重定向的区别" class="headerlink" title="转发与重定向的区别"></a>转发与重定向的区别</h2><ol>
<li>重定向属于发送两次请求，转发发送一次请求</li>
<li>重定向地址栏会发生变化，转发地址不变</li>
<li>重新定向可以访问外部网站 转发只能访问服务器内部资源</li>
<li>转发的性能要优于重定向</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/10/get与post的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/get与post的区别/" itemprop="url">get 与 post 的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-10T00:00:00+08:00">2017-08-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/http/" itemprop="url" rel="index"><span itemprop="name">http</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1、GET请求，请求的数据会附加在URL之后，以?分割URL和传输数据，多个参数用&amp;连接。URL的编码格式采用的是ASCII编码，而不是uniclde，即是说所有的非ASCII字符都要编码之后再传输。</p>
<p>POST请求：POST请求会把请求的数据放置在HTTP请求包的包体中。上面的item=bandsaw就是实际的传输数据。</p>
<p>因此，GET请求的数据会暴露在地址栏中，而POST请求则不会。</p>
<p>2、传输数据的大小</p>
<p>在HTTP规范中，没有对URL的长度和传输的数据大小进行限制。但是在实际开发过程中，对于GET，特定的浏览器和服务器对URL的长度有限制。因此，在使用GET请求时，传输数据会受到URL长度的限制。</p>
<p>对于POST，由于不是URL传值，理论上是不会受限制的，但是实际上各个服务器会规定对POST提交数据大小进行限制，Apache、IIS都有各自的配置。</p>
<p>3、安全性</p>
<p>POST的安全性比GET的高。这里的安全是指真正的安全，而不同于上面GET提到的安全方法中的安全，上面提到的安全仅仅是不修改服务器的数据。比如，在进行登录操作，通过GET请求，用户名和密码都会暴露再URL上，因为登录页面有可能被浏览器缓存以及其他人查看浏览器的历史记录的原因，此时的用户名和密码就很容易被他人拿到了。除此之外，GET请求提交的数据还可能会造成Cross-site request frogery攻击</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/10/http状态码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="h#">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="learningByDoing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/http状态码/" itemprop="url">常见状态码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-10T00:00:00+08:00">2017-08-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/http/" itemprop="url" rel="index"><span itemprop="name">http</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>200 OK 服务器成功处理请求</p>
<p>301/302 Moved Permanently（重定向）请求的URL已移走。响应报文中应该包含一个Location URL，说明资源现在所处的位置</p>
<p>304 Not Modified（未修改） 客户的缓存资源是最新的，要客户端使用缓存内容</p>
<p>404 Not Found 未找到资源</p>
<p>501 Internal Server Error 服务器遇到错误，使其无法对请求提供服务</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="h#" />
            
              <p class="site-author-name" itemprop="name">h#</p>
              <p class="site-description motion-element" itemprop="description">所学即所得</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">h#</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.3"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
